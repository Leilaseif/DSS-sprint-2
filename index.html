<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Video Player with Guided Chatbot</title>
        <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 50px;
        }
        video {
            width: 70%;
            max-width: 800px;
            border: 3px solid black;
            border-radius: 10px;
        }
        /* Chatbot Styles */
        .chat-container {
            width: 300px;
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            padding: 10px;
        }
        .chat-box {
            height: 200px;
            overflow-y: auto;
            border-bottom: 1px solid #ccc;
            padding: 5px;
        }
        .input-box {
            display: flex;
            margin-top: 5px;
        }
        .input-box input {
            width: 80%;
            padding: 5px;
        }
        .input-box button {
            width: 20%;
            background: blue;
            color: white;
            border: none;
            cursor: pointer;
        }
        .chat-toggle {
            position: fixed;
            bottom: 20px;
            right: 330px;
            background: blue;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
        }

        /* Popup Styles */
        .popup {
            position: absolute;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 20px;
            border-radius: 10px;
            font-size: 18px;
            display: none;
            z-index: 10;
        }
    </style>
    </head>
    <body>
        <h2>AI Training</h2>
        <video id="myVideo" controls>
            <source src="my-video.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>

        <!-- Chatbot Button -->
        <button class="chat-toggle" onclick="toggleChat()">Chat</button>

        <!-- Chatbot Section -->
        <div class="chat-container" id="chatContainer" style="display: none;">
            <h3>Chatbot</h3>
            <div class="chat-box" id="chatBox"></div>
            <div class="input-box">
                <input type="text" id="userInput"
                    placeholder="Type your answer...">
                <button onclick="sendMessage()">Send</button>
            </div>
        </div>

        <!-- Popup Message -->
        <div id="popup" class="popup">
            A black box AI is an AI system whose internal workings are a mystery
            to its users
        </div>

        <script>
        let questions = [
            "What is your name?",
            "How are you feeling today?",
            "What is your favorite movie?",
            "Where are you from?",
            "Do you like watching videos?",
            "What topic interests you the most?",
            "What do you hope to learn today?",
            "Any final thoughts before we end?"
        ];

        let currentQuestion = 0;
        let answers = JSON.parse(localStorage.getItem("chatAnswers")) || {}; // Load previous answers

        // Show popup at 7 seconds in video
        const video = document.getElementById("myVideo");
        const popup = document.getElementById("popup");

        video.addEventListener("timeupdate", function() {
            if (video.currentTime >= 7 && video.currentTime < 11) {
                popup.style.display = "block"; // Show popup
            } else {
                popup.style.display = "none"; // Hide popup after 4 seconds
            }
        });

        function toggleChat() {
            let chatContainer = document.getElementById("chatContainer");
            if (chatContainer.style.display === "none") {
                chatContainer.style.display = "block";
                startChat();
            } else {
                chatContainer.style.display = "none";
            }
        }

        function startChat() {
            let chatBox = document.getElementById("chatBox");
            chatBox.innerHTML = ""; // Clear chat
            currentQuestion = 0;
            showNextQuestion();
        }

        function showNextQuestion() {
            if (currentQuestion < questions.length) {
                document.getElementById("chatBox").innerHTML += `<p><strong>Bot:</strong> ${questions[currentQuestion]}</p>`;
            } else {
                document.getElementById("chatBox").innerHTML += `<p><strong>Bot:</strong> Thank you for chatting with me! ðŸ˜Š</p>`;
                console.log("Saved Answers:", answers); // Debugging: See answers in browser console
                localStorage.setItem("chatAnswers", JSON.stringify(answers)); // Save to local storage
            }
        }

        function sendMessage() {
            let userInput = document.getElementById("userInput").value.trim();
            let chatBox = document.getElementById("chatBox");

            if (userInput === "") return;

            // Store answer
            answers[questions[currentQuestion]] = userInput;

            // Display user message
            chatBox.innerHTML += `<p><strong>You:</strong> ${userInput}</p>`;

            // Move to next question
            currentQuestion++;
            setTimeout(showNextQuestion, 500);

            // Clear input
            document.getElementById("userInput").value = "";
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        // Listen for Enter key press
        document.getElementById("userInput").addEventListener("keydown", function(event) {
            if (event.key === "Enter") {
                event.preventDefault(); // Prevent form submission if in a form
                sendMessage(); // Call sendMessage when Enter is pressed
            }
        });
        </script>
    </body>
</html>
